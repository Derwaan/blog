<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.0.1">Jekyll</generator><link href="https://derwaan.com/blog/blog/feed.xml" rel="self" type="application/atom+xml" /><link href="https://derwaan.com/blog/blog/" rel="alternate" type="text/html" hreflang="en" /><updated>2020-05-15T11:17:50+02:00</updated><id>https://derwaan.com/blog/blog/feed.xml</id><title type="html">Derwaan</title><subtitle>Embedded Software Engineer, Freelancer and IoT geek</subtitle><entry><title type="html">My note-taking experiment - Part 1</title><link href="https://derwaan.com/blog/blog/2020/05/14/note-taking-experiment-part-1.html" rel="alternate" type="text/html" title="My note-taking experiment - Part 1" /><published>2020-05-14T00:00:00+02:00</published><updated>2020-05-14T00:00:00+02:00</updated><id>https://derwaan.com/blog/blog/2020/05/14/note-taking-experiment-part-1</id><content type="html" xml:base="https://derwaan.com/blog/blog/2020/05/14/note-taking-experiment-part-1.html">&lt;p&gt;During my studies, I kept looking a the &lt;em&gt;perfect&lt;/em&gt; note-taking method.
I have tried a lot of them (mind-maps, Cornell, flash-card, …) but never have I been convinced by one of them.&lt;/p&gt;

&lt;p&gt;Now that I have left University (at least for now?), I have this urge to take notes on everything but whitout the correct framework.&lt;/p&gt;

&lt;p&gt;Let me explain.
At University, the framework was simple: take notes during the lectures, study those notes, and succeed at the exams (the last step might depends from time to time).
But now that the University time is over, I find myself with a bunch of notes that I don’t know how to organize.
I take notes during meetings, I take notes when I am facing a difficult challenge at work, I take notes when I have an amazing idea for a start-up, I take notes of interesting books, etc…&lt;/p&gt;

&lt;p&gt;I have those notes that if I don’t do anything with them, they will never be used (bye start-up idea worth millions of dollars).&lt;/p&gt;

&lt;p&gt;So, I have decided to put myself into a small experiment in order to find the perfect note-taking workflow.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;tl;dr&lt;/strong&gt; My note-taking system has three steps (1. Capture ideas into a notebook; 2. Review et categorize those notes; 3. Create something from those notes). I will write more posts that will describe my follow-ups on this experiment.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1 id=&quot;an-experimental-system&quot;&gt;An experimental system&lt;/h1&gt;

&lt;p&gt;&lt;img src=&quot;/blog/images/habit-of-taking-notes.jpg&quot; alt=&quot;Habit of taking notes&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This note-taking system is divided into three steps.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;First, capture the ideas (into a notebook or with Notability)&lt;/li&gt;
  &lt;li&gt;Second, review those notes in order to better understand them and filter out the bad ones&lt;/li&gt;
  &lt;li&gt;Finally, create something from those notes. Without this last step, all this process is irrelevant.&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;1a-taking-notes-in-a-notebook&quot;&gt;1a. Taking notes in a notebook&lt;/h2&gt;

&lt;p&gt;I have been using a Bullet Journal for the last months.
I write down in this notebook &lt;em&gt;almost&lt;/em&gt; everything: ideas, meetings, tasks, …
I also keep track of interesting chat I had during the day.
After the work, I log every piece of information that might be useful for later.
My goal with this journal is not to have something beautiful to show on Instagram.
No, this journal is full of notes that only make sense for me.
But at least, I know that everything I need is in this notebook.
No need to trust my brain and its memory to remember what was said during the meeting or what was the start-up idea I had this morning.&lt;/p&gt;

&lt;p&gt;Sometimes, when I want to go deeper with an idea, I take a full page in my notebook to draw, write a mind-map or any other way that helps me.&lt;/p&gt;

&lt;h2 id=&quot;1b-using-notability&quot;&gt;1b. Using Notability&lt;/h2&gt;

&lt;p&gt;When I am reading a book, I directly take notes in it (if I have it physically) or I create highlights with my Kindle.
Doing this, helps me be focus on the reading.
Once the book is finished, I create a summary with the main ideas.
I don’t just transcribe them verbatim.
I write them with my own words in order for me to better grasp the notions behind the book.&lt;/p&gt;

&lt;p&gt;Those notes, I could just use my Bullet Journal to take them.
But I prefer using Notability on my iPad.
It allows me to store those notes more easily and it prevents my Bullet Journal of running out of pages quickly.&lt;/p&gt;

&lt;h2 id=&quot;2-review-my-notes&quot;&gt;2. Review my notes&lt;/h2&gt;

&lt;p&gt;Ok, so I takes notes in my journal (or with Notability) and that’s good.
Taking notes of everything allows the mind to be free and focus on our work.
But with all these ideas put together, how to find (or retrieve) the best ones?
The ones that will allow me to build the best start-up in the world?&lt;/p&gt;

&lt;p&gt;After one week or two, I get back to my notes and review them.
This delay allows me to forget about my notes and rediscover what I have written.
At this moment, I can decide if this idea is worthless (that occurs a lot with me) or if this note is important for me.
If the though is important, I extract it from my notebook (or Notability) and write it down on a piece of paper.
This piece of paper is then stored and categorized to be found later when needed.&lt;/p&gt;

&lt;p&gt;This place where all the best ideas are stored is my &lt;strong&gt;commonplace book&lt;/strong&gt;.
In my case, I use an Atoma notebook with detachable sheets.&lt;/p&gt;

&lt;h2 id=&quot;3-create-something-from-my-notes&quot;&gt;3. Create something from my notes&lt;/h2&gt;

&lt;p&gt;Here we are.
My notes are securely stored and categorized and I can find them back whenever I want.
But even with this all process, this is worthless if I don’t create something.&lt;/p&gt;

&lt;p&gt;With my commonplace book, I can retrieve my notes and build something with them.
That could be an article like this one or a start-up that will change the world, everything starts with a note.
Applying what we learn allows us to remember more.
Creating and sharing your work with others might be the best way to learn.&lt;/p&gt;

&lt;h1 id=&quot;final-words&quot;&gt;Final words&lt;/h1&gt;

&lt;p&gt;I will start to apply this system (already did with this article) that I will document with follow-up articles.
I think this can be useful for people that, like me, look for the perfect note-taking system.&lt;/p&gt;</content><author><name></name></author><summary type="html">During my studies, I kept looking a the perfect note-taking method. I have tried a lot of them (mind-maps, Cornell, flash-card, …) but never have I been convinced by one of them.</summary></entry><entry><title type="html">How to emulate a webcam stream with Python3, OpenCV and v4l2loopback</title><link href="https://derwaan.com/blog/blog/2020/05/12/v4l2loopback-opencv.html" rel="alternate" type="text/html" title="How to emulate a webcam stream with Python3, OpenCV and v4l2loopback" /><published>2020-05-12T00:00:00+02:00</published><updated>2020-05-12T00:00:00+02:00</updated><id>https://derwaan.com/blog/blog/2020/05/12/v4l2loopback-opencv</id><content type="html" xml:base="https://derwaan.com/blog/blog/2020/05/12/v4l2loopback-opencv.html">&lt;p&gt;In this article, we are going to create a virtual device using v4l2loopback on which we are going to write frames with OpenCV.&lt;/p&gt;

&lt;p&gt;This article assumes that Python3, pip3 and OpenCV are installed.
The techniques and tools presented in this article were tested on Ubuntu 18.04.&lt;/p&gt;

&lt;h2 id=&quot;context&quot;&gt;Context&lt;/h2&gt;

&lt;p&gt;At Nalys, a previous Qt application was created during a project. This application reads the video device of a tablet and performs some video processing algorithms with OpenCV. This &lt;a href=&quot;https://nalys-taas-projects.gitlab.io/internal/taas_blog/post/qt_app_led_detection/&quot;&gt;blog post&lt;/a&gt; describes in more depth the application. But to test the application, you would need to have a video device plugged to your computer. In order to remove this constraint, a python script was created. This script emulates a video device that the Qt application will read and use for the video processing.&lt;/p&gt;

&lt;p&gt;Before writing the script, some research were necessary in order to find the correct tools for such task.&lt;/p&gt;

&lt;h3 id=&quot;v4l2-and-v4l2loopback&quot;&gt;v4l2 and v4l2loopback&lt;/h3&gt;

&lt;p&gt;V4l2 or “Video4Linux” is an API that allows to capture video device. V4l2loopback is a kernel module not installed by default that can create virtual video devices (or “dummy devices”) that any v4l2 application would be able to read.&lt;/p&gt;

&lt;p&gt;For our case, v4l2loopback will be used to create a dummy device that the Qt application will be able to read. But in order to write frame to this virtual device, we need something else.&lt;/p&gt;

&lt;h3 id=&quot;opencv&quot;&gt;OpenCV&lt;/h3&gt;

&lt;p&gt;OpenCV is a famous library for video processing. In our script, we will only use a small portion of the capabilities of this library to create frame for our v4l2loopback device.&lt;/p&gt;

&lt;h2 id=&quot;preparations&quot;&gt;Preparations&lt;/h2&gt;

&lt;p&gt;Before writing our Python3 script, we need to make some preparations.
In order for our script to write frames on a virtual device, we will need to install and use the v4l2loopback kernel module that creates such devices.&lt;/p&gt;

&lt;h3 id=&quot;install-v4l2-and-v4l2loopback&quot;&gt;Install v4l2 and v4l2loopback&lt;/h3&gt;

&lt;p&gt;In order to create a dummy device that will be used by OpenCV to display the frames, we will need to install &lt;a href=&quot;v4l2loopback&quot;&gt;https://github.com/umlaeute/v4l2loopback&lt;/a&gt;.&lt;/p&gt;

&lt;h4 id=&quot;with-a-package-manager&quot;&gt;With a package manager&lt;/h4&gt;

&lt;p&gt;A Debian package is available for Debian-based distribution.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;v4l2loopback-dkms
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;from-source&quot;&gt;From source&lt;/h4&gt;

&lt;p&gt;With Ubuntu 18.04, there can be some issues with this package and we might want to install v4l2loopback from source.
To do so, we will need to have the latest kernel headers for our system:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;linux-headers-&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After that, we can clone the v4l2loopback &lt;a href=&quot;repository&quot;&gt;https://github.com/umlaeute/v4l2loopback&lt;/a&gt; and install the kernel module from the source:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git clone https://github.com/umlaeute/v4l2loopback
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;v4l2loopback
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;make
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;make &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;depmod &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We might need to install &lt;code class=&quot;highlighter-rouge&quot;&gt;v4l-utils&lt;/code&gt; if it is not present in our system yet.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;v4l-utils
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In order to use v4l2 in Python3, we will need to install the package &lt;code class=&quot;highlighter-rouge&quot;&gt;v4l2&lt;/code&gt; with pip3.
But, currently this package has a bug with Python3 and it need to be installed from a specific commit that fixes the issue.
In order to install the package with pip3, we will also need to have &lt;code class=&quot;highlighter-rouge&quot;&gt;bzr&lt;/code&gt; installed.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;bzr
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;pip3 &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; bzr+lp:~jgottula/python-v4l2/fix-for-bug-1664158
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;creating-a-dummy-device&quot;&gt;Creating a dummy device&lt;/h3&gt;

&lt;p&gt;Now that we have all the requirements installed, it is time to create our first dummy device.&lt;/p&gt;

&lt;p&gt;Using v4l2loopback kernel module, we can add our freshly installed kernel module:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;modprobe v4l2loopback
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With v4l-utils, we can check if the virtual video device is created:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;v4l2-ctl &lt;span class=&quot;nt&quot;&gt;--list-device&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We should see a dummy device in the list.&lt;br /&gt;
We will consider &lt;code class=&quot;highlighter-rouge&quot;&gt;/dev/video0&lt;/code&gt; as the virtual device created by v4l2loopback for the next part of this article.&lt;/p&gt;

&lt;h2 id=&quot;python-script&quot;&gt;Python script&lt;/h2&gt;

&lt;p&gt;Now that every things is set up, let’s move on to the actual script.&lt;/p&gt;

&lt;h3 id=&quot;opening-the-virtual-device&quot;&gt;Opening the virtual device&lt;/h3&gt;
&lt;p&gt;Before writing our frames to the virtual device, we must create a v4l2 format.
This format will be then written into the device with ioctl.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fcntl&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;v4l2&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1920&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1080&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/dev/video0'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'wb'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Setup format
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;                      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v4l2_format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;                 &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;V4L2_BUF_TYPE_VIDEO_OUTPUT&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;field&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;V4L2_FIELD_NONE&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pixelformat&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;V4L2_PIX_FMT_BGR24&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bytesperline&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sizeimage&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Writing the format to the virtual device
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fcntl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ioctl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;VIDIOC_S_FMT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Running on {}&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;generate-a-frame&quot;&gt;Generate a frame&lt;/h3&gt;
&lt;p&gt;Once we have the device open with the correct format, we can generate frames with numpy and OpenCV.
We use an infinite loop to keep sending new frames to the dummy device.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;cv2&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;frame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uint8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Generate a black frame
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;cv2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;circle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Filled circle
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Write the frame to the virtual device
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;reading-our-virtual-device&quot;&gt;Reading our virtual device&lt;/h2&gt;

&lt;p&gt;We can now run our script and use VLC to check if our virtual device is displaying our frames.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3 our_script.py &amp;amp;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vlc v4l2:///dev/video0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;clean-it-up&quot;&gt;Clean it up&lt;/h2&gt;

&lt;p&gt;To remove the virtual device, you can simply remove the kernel module:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;rmmod v4l2loopback
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html">In this article, we are going to create a virtual device using v4l2loopback on which we are going to write frames with OpenCV.</summary></entry></feed>